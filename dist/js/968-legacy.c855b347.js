"use strict";(self["webpackChunkwork"]=self["webpackChunkwork"]||[]).push([[968],{11968:function(e,t,n){n.r(t),n.d(t,{default:function(){return h}});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-snackbar",{attrs:{timeout:2e3,absolute:"",centered:"",top:"",color:e.success?"green":"red"},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.msg)+" ")]),e.userData?n("v-card",[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.userData,"sort-by":"name"},scopedSlots:e._u([{key:"top",fn:function(){return[n("v-toolbar",{attrs:{flat:""}},[n("v-toolbar-title",[e._v("Danh sách học sinh")]),n("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),n("v-spacer"),n("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,i=t.attrs;return[n("v-btn",e._g(e._b({staticClass:"mb-2",attrs:{color:"primary",dark:""}},"v-btn",i,!1),a),[e._v(" Thêm học sinh ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"text-h5"},[e._v(e._s(-1===e.editedIndex?"Thêm học sinh":"Sửa học sinh"))])]),n("v-card-text",[n("v-container",[n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-text-field",{attrs:{rules:e.nameRules,disabled:e.loading,label:"Họ tên"},model:{value:e.editedItem.name,callback:function(t){e.$set(e.editedItem,"name",t)},expression:"editedItem.name"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,i=t.attrs;return[n("v-text-field",e._g(e._b({attrs:{label:"Ngày sinh","prepend-icon":"mdi-calendar",disabled:e.loading,readonly:"",rules:e.dobRules},model:{value:e.editedItem.dateOfBirth,callback:function(t){e.$set(e.editedItem,"dateOfBirth",t)},expression:"editedItem.dateOfBirth"}},"v-text-field",i,!1),a))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[n("v-date-picker",{on:{input:function(t){e.menu=!1}},model:{value:e.editedItem.dateOfBirth,callback:function(t){e.$set(e.editedItem,"dateOfBirth",t)},expression:"editedItem.dateOfBirth"}})],1)],1),n("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[n("v-text-field",{attrs:{type:"email",disabled:e.loading,rules:e.emailRules,label:"Email"},model:{value:e.editedItem.email,callback:function(t){e.$set(e.editedItem,"email",t)},expression:"editedItem.email"}})],1),n("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[n("v-text-field",{attrs:{type:"password",disabled:e.loading,rules:-1===e.editedIndex?[function(e){return!!e||"Paassword không được để trống"},function(e){return e.length>3||"Mật khẩu ít nhất 3 ký tự"}]:[],label:"Mật khẩu"},model:{value:e.editedItem.password,callback:function(t){e.$set(e.editedItem,"password",t)},expression:"editedItem.password"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-select",{attrs:{disabled:e.loading,items:e.sex,"item-text":"text",rules:[function(e){return!!e||"Chọn giới tính"}],"item-value":"value",label:"Giới tính","single-line":""},model:{value:e.editedItem.sex,callback:function(t){e.$set(e.editedItem,"sex",t)},expression:"editedItem.sex"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{disabled:e.loading,rules:e.roomRules,label:"Lớp"},model:{value:e.editedItem.room,callback:function(t){e.$set(e.editedItem,"room",t)},expression:"editedItem.room"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-select",{attrs:{disabled:e.loading,items:e.roles,"item-text":"text",rules:[function(e){return!!e||"Chọn quyền"}],"item-value":"value",label:"Quyền","single-line":""},model:{value:e.editedItem.role,callback:function(t){e.$set(e.editedItem,"role",t)},expression:"editedItem.role"}})],1)],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v(" Đóng ")]),n("v-btn",{attrs:{disabled:!e.valid||e.loading,color:"blue"},on:{click:e.save}},[e._v(" Lưu ")])],1)],1)],1),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}},[n("v-card",[n("v-card-title",{staticClass:"text-h5"},[e._v("Bạn muốn xoá học sinh này?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.closeDelete}},[e._v("Đóng")]),n("v-btn",{attrs:{color:"blue darken-1",text:"",disabled:e.loading},on:{click:e.deleteItemConfirm}},[e._v("Xoá")]),n("v-spacer")],1)],1)],1)],1)]},proxy:!0},{key:"item.actions",fn:function(t){var a=t.item;return[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(a)}}},[e._v(" mdi-pencil ")]),n("v-icon",{attrs:{small:""},on:{click:function(t){return e.deleteItem(a)}}},[e._v(" mdi-delete ")])]}},{key:"no-data",fn:function(){return[n("v-btn",{attrs:{color:"primary"},on:{click:e.initialize}},[e._v(" Reset ")])]},proxy:!0}])})],1):n("h1",[e._v("Không có dữ liệu học sinh!")])],1)},i=[],s=n(93019),r=n(67906),l=n(16198),c=(n(74916),n(77601),n(21249),n(23123),n(40561),n(99023)),d=n(96838),o={name:"UsersPage",data:function(){return{valid:!0,snackbar:!1,success:!1,msg:"",tableLoading:!1,userData:[],dialog:!1,dialogDelete:!1,editedItem:{id:"",name:"",dateOfBirth:null,email:"",role:"",room:"",sex:"",password:""},loading:!1,e6:[],nameRules:[function(e){return!!e||"Tên không được để trống"}],dobRules:[function(e){return!!e||"Ngày sinh không được bỏ trống"}],roomRules:[function(e){return!!e||"Lớp không được bỏ trống"}],emailRules:[function(e){return!!e||"Email không được để trống"},function(e){return/.+@.+\..+/.test(e)||"Email không đúng định dạng"}],select:null,roles:[{text:"Người dùng",value:"user"},{text:"Quản trị viên",value:"admin"}],sex:[{text:"Nam",value:"Nam"},{text:"Nữ",value:"Nữ"}],menu:!1,time:null,editedIndex:-1,headers:[{text:"Họ tên",align:"start",value:"name"},{text:"Ngày sinh",align:"start",value:"dateOfBirth"},{text:"Giới tính",align:"start",value:"sex"},{text:"Lớp",align:"start",value:"room"},{text:"Email",align:"start",value:"email"},{text:"Quyền",align:"start",value:"role"},{text:"Hành động",align:"start",value:"actions"}]}},watch:{dialog:function(e){e||this.close()},dialogDelete:function(e){e||this.closeDelete()}},created:function(){var e=this;return(0,l.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getAllUsers();case 2:case"end":return t.stop()}}),t)})))()},methods:{validate:function(){this.$refs.form.validate()},editItem:function(e){this.editedIndex=this.userData.indexOf(e),this.editedItem=(0,s.Z)({},e),this.dialog=!0},deleteItem:function(e){this.editedIndex=this.userData.indexOf(e),this.editedItem=(0,s.Z)({},e),this.dialogDelete=!0},deleteItemConfirm:function(){var e=this;return(0,l.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.deleteUser();case 2:case"end":return t.stop()}}),t)})))()},close:function(){var e=this;this.dialog=!1,this.$nextTick((function(){e.editedItem=(0,s.Z)({},e.defaultItem),e.editedIndex=-1}))},closeDelete:function(){var e=this;this.dialogDelete=!1,this.$nextTick((function(){e.editedItem=(0,s.Z)({},e.defaultItem),e.editedIndex=-1}))},getAllUsers:function(){var e=this;return(0,l.Z)((0,r.Z)().mark((function t(){var n;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.tableLoading=!0,t.next=4,(0,c.Y8)();case 4:n=t.sent,e.userData=n.data.map((function(e){var t=e.dateOfBirth.split("T")[0];return Object.assign(e,{dateOfBirth:t}),e})),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:return t.prev=11,e.tableLoading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})))()},createUser:function(){var e=this;return(0,l.Z)((0,r.Z)().mark((function t(){var n;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,n=(0,d.Cl)(e.editedItem),delete n.id,n.dateOfBirth=new Date(n.dateOfBirth).toISOString(),t.next=7,(0,c.r4)(n);case 7:e.userData.push(e.editedItem),e.snackbar=!0,e.success=!0,e.msg="Thêm thành công",e.close(),t.next=20;break;case 14:t.prev=14,t.t0=t["catch"](0),e.snackbar=!0,e.success=!1,e.msg="Cõ lỗi khi tạo dữ liệu, thử lại sau",console.log(t.t0);case 20:return t.prev=20,e.loading=!1,t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[0,14,20,23]])})))()},updateUser:function(){var e=this;return(0,l.Z)((0,r.Z)().mark((function t(){var n,a;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,n=(0,d.Cl)(e.editedItem),a=n.id,delete n.id,delete n.works,delete n.isEmailVerified,n.dateOfBirth=new Date(n.dateOfBirth).toISOString(),t.next=10,(0,c.Nq)(a,n);case 10:Object.assign(e.userData[e.editedIndex],e.editedItem),e.snackbar=!0,e.success=!0,e.msg="Sửa thành công",e.close(),t.next=23;break;case 17:t.prev=17,t.t0=t["catch"](0),e.snackbar=!0,e.success=!1,e.msg="Cõ lỗi khi tạo dữ liệu, thử lại sau",console.log(t.t0);case 23:return t.prev=23,e.loading=!1,t.finish(23);case 26:case"end":return t.stop()}}),t,null,[[0,17,23,26]])})))()},deleteUser:function(){var e=this;return(0,l.Z)((0,r.Z)().mark((function t(){var n,a;return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,n=(0,d.Cl)(e.editedItem),a=n.id,t.next=6,(0,c.h8)(a);case 6:e.userData.splice(e.editedIndex,1),e.snackbar=!0,e.success=!0,e.msg="Xoá thành công",e.closeDelete(),t.next=19;break;case 13:t.prev=13,t.t0=t["catch"](0),e.snackbar=!0,e.success=!1,e.msg="Cõ lỗi khi tạo dữ liệu, thử lại sau",console.log(t.t0);case 19:return t.prev=19,e.loading=!1,t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[0,13,19,22]])})))()},save:function(){var e=this;return(0,l.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.editedIndex>-1)){t.next=5;break}return t.next=3,e.updateUser();case 3:t.next=7;break;case 5:return t.next=7,e.createUser();case 7:e.validate();case 8:case"end":return t.stop()}}),t)})))()}}},u=o,m=n(1001),v=(0,m.Z)(u,a,i,!1,null,null,null),h=v.exports}}]);
//# sourceMappingURL=968-legacy.c855b347.js.map