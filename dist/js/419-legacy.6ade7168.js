"use strict";(self["webpackChunkwork"]=self["webpackChunkwork"]||[]).push([[419],{60419:function(e,t,n){n.r(t),n.d(t,{default:function(){return x}});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-snackbar",{attrs:{timeout:2e3,absolute:"",centered:"",top:"",color:e.success?"green":"red"},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.msg)+" ")]),e.workData?n("v-card",[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.workData,"sort-by":"name"},scopedSlots:e._u([{key:"top",fn:function(){return[n("v-toolbar",{attrs:{flat:""}},[n("v-toolbar-title",[e._v("Danh sách bảng trực nhật đã tạo")]),n("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),n("v-spacer"),n("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-btn",e._g(e._b({staticClass:"mb-2",attrs:{color:"primary",dark:""}},"v-btn",r,!1),a),[e._v(" Thêm bảng trực nhật ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"text-h5"},[e._v(e._s(-1===e.editedIndex?"Thêm bảng trực nhật":"Sửa bảng trực nhật"))])]),n("v-card-text",[n("v-container",[n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"6",md:"12"}},[n("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({attrs:{label:"Ngày thực hiện",disabled:e.loading,readonly:"",rules:e.notEmptyDate},model:{value:e.editedItem.date,callback:function(t){e.$set(e.editedItem,"date",t)},expression:"editedItem.date"}},"v-text-field",r,!1),a))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[n("v-date-picker",{on:{input:function(t){e.menu=!1}},model:{value:e.editedItem.date,callback:function(t){e.$set(e.editedItem,"date",t)},expression:"editedItem.date"}})],1)],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"12"}},[n("v-select",{attrs:{items:e.userData,"item-text":"name","item-value":"id","menu-props":{maxHeight:"400"},label:"Chọn học sinh tham gia",multiple:"","persistent-hint":"",rules:e.notEmptyUsers},model:{value:e.editedItem.users,callback:function(t){e.$set(e.editedItem,"users",t)},expression:"editedItem.users"}})],1),n("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[n("v-textarea",{attrs:{type:"text",disabled:e.loading,label:"Ghi chú"},model:{value:e.editedItem.description,callback:function(t){e.$set(e.editedItem,"description",t)},expression:"editedItem.description"}})],1),n("v-col",{attrs:{cols:"12",sm:"12"}},[n("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.editedItem.expires,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){return e.$set(e.editedItem,"expires",t)},"update:return-value":function(t){return e.$set(e.editedItem,"expires",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-text-field",e._g(e._b({attrs:{label:"Chọn giờ kết thúc",readonly:"",rles:e.notEmptyExpires},model:{value:e.editedItem.expires,callback:function(t){e.$set(e.editedItem,"expires",t)},expression:"editedItem.expires"}},"v-text-field",r,!1),a))]}}]),model:{value:e.menu2,callback:function(t){e.menu2=t},expression:"menu2"}},[e.menu2?n("v-time-picker",{attrs:{"full-width":""},on:{"click:minute":function(t){return e.$refs.menu.save(e.editedItem.expires)}},model:{value:e.editedItem.expires,callback:function(t){e.$set(e.editedItem,"expires",t)},expression:"editedItem.expires"}}):e._e()],1)],1)],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v(" Đóng ")]),n("v-btn",{attrs:{disabled:!e.valid||e.loading,color:"blue"},on:{click:e.save}},[e._v(" Lưu ")])],1)],1)],1),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}},[n("v-card",[n("v-card-title",{staticClass:"text-h5"},[e._v("Bạn muốn xoá dữ liệu này?")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.closeDelete}},[e._v("Đóng")]),n("v-btn",{attrs:{color:"blue darken-1",text:"",disabled:e.loading},on:{click:e.deleteItemConfirm}},[e._v("Xoá")]),n("v-spacer")],1)],1)],1)],1)]},proxy:!0},{key:"item.users",fn:function(t){var a=t.item;return e._l(e.filterUser(a.users),(function(t){return n("p",{key:t.id},[e._v(e._s(t.name))])}))}},{key:"item.description",fn:function(t){var a=t.item;return[n("p",[e._v(e._s(a.description?a.description:"-"))])]}},{key:"item.actions",fn:function(t){var a=t.item;return[n("v-icon",{attrs:{small:""},on:{click:function(t){return e.deleteItem(a)}}},[e._v(" mdi-delete ")])]}},{key:"no-data",fn:function(){return[n("v-btn",{attrs:{color:"primary"},on:{click:e.initialize}},[e._v(" Reset ")])]},proxy:!0}])})],1):n("h1",[e._v("Không có dữ liệu trực nhật!")])],1)},r=[],i=n(13571),s=n(93019),c=n(67906),o=n(16198),l=(n(41539),n(78783),n(33948),n(21249),n(57327),n(74916),n(23123),n(26699),n(32023),n(40561),n(68309),n(81428)),d=n(99023),u=n(96838),m=n(91709),v={name:"UsersPage",data:function(){return{valid:!0,snackbar:!1,success:!1,msg:"",tableLoading:!1,workData:[],dialog:!1,dialogDelete:!1,editedItem:{id:"",date:"",users:null,description:"",expires:""},loading:!1,e6:[],notEmptyDate:[function(e){return!!e||"Trường này không được để trống."}],notEmptyUsers:[function(e){return!!e||"Trường này không được để trống."}],notEmptyExpires:[function(e){return!!e||"Trường này không được để trống."}],select:null,menu:!1,menu2:!1,time:null,editedIndex:-1,headers:[{text:"Ngày mở",align:"start",value:"date"},{text:"Học sinh tham gia",align:"start",value:"users"},{text:"Ghi chú",align:"start",value:"description"},{text:"Giờ hết hạn",align:"start",value:"expires"},{text:"Hành động",align:"start",value:"actions"}]}},watch:{dialog:function(e){e||this.close()},dialogDelete:function(e){e||this.closeDelete()}},created:function(){var e=this;return(0,o.Z)((0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getData();case 2:case"end":return t.stop()}}),t)})))()},methods:{validate:function(){this.$refs.form.validate()},editItem:function(e){this.editedIndex=this.workData.indexOf(e),this.editedItem=(0,s.Z)({},e),this.dialog=!0},deleteItem:function(e){this.editedIndex=this.workData.indexOf(e),this.editedItem=(0,s.Z)({},e),this.dialogDelete=!0},deleteItemConfirm:function(){var e=this;return(0,o.Z)((0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.deleteWork();case 2:case"end":return t.stop()}}),t)})))()},close:function(){var e=this;this.dialog=!1,this.$nextTick((function(){e.editedItem=(0,s.Z)({},e.defaultItem),e.editedIndex=-1}))},closeDelete:function(){var e=this;this.dialogDelete=!1,this.$nextTick((function(){e.editedItem=(0,s.Z)({},e.defaultItem),e.editedIndex=-1}))},getData:function(){var e=this;return(0,o.Z)((0,c.Z)().mark((function t(){var n,a,r,s;return(0,c.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.tableLoading=!0,t.next=4,Promise.all([(0,d.Y8)(),(0,l.ib)()]);case 4:n=t.sent,a=(0,i.Z)(n,2),r=a[0],s=a[1],e.userData=r.data,e.workData=s.data.filter((function(e){return(0,m.cV)(e.date)})).map((function(e){var t=e.date;return t=t.split("T")[0],Object.assign(e,{date:t}),e})),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log(t.t0);case 15:return t.prev=15,e.tableLoading=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[0,12,15,18]])})))()},createWork:function(){var e=this;return(0,o.Z)((0,c.Z)().mark((function t(){var n;return(0,c.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,n=(0,u.Cl)(e.editedItem),delete n.id,n.date=new Date(n.date).toISOString(),t.next=7,(0,l.UU)(n);case 7:e.editedItem.users=e.userData.filter((function(e){return n.users.includes(e.id)})),e.workData.push(e.editedItem),e.snackbar=!0,e.success=!0,e.msg="Thêm thành công",e.close(),t.next=21;break;case 15:t.prev=15,t.t0=t["catch"](0),e.snackbar=!0,e.success=!1,e.msg="Cõ lỗi khi tạo dữ liệu, thử lại sau",console.log(t.t0);case 21:return t.prev=21,e.loading=!1,t.finish(21);case 24:case"end":return t.stop()}}),t,null,[[0,15,21,24]])})))()},deleteWork:function(){var e=this;return(0,o.Z)((0,c.Z)().mark((function t(){var n,a;return(0,c.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,n=(0,u.Cl)(e.editedItem),a=n.id,t.next=6,(0,l.Js)(a);case 6:e.workData.splice(e.editedIndex,1),e.snackbar=!0,e.success=!0,e.msg="Xoá thành công",e.closeDelete(),t.next=19;break;case 13:t.prev=13,t.t0=t["catch"](0),e.snackbar=!0,e.success=!1,e.msg="Cõ lỗi khi tạo dữ liệu, thử lại sau",console.log(t.t0);case 19:return t.prev=19,e.loading=!1,t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[0,13,19,22]])})))()},save:function(){var e=this;return(0,o.Z)((0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.editedIndex>-1)){t.next=5;break}return t.next=3,e.updateUser();case 3:t.next=7;break;case 5:return t.next=7,e.createWork();case 7:e.validate();case 8:case"end":return t.stop()}}),t)})))()},filterUser:function(e){return e.map((function(e){return{name:e.name,id:e.id}}))}}},f=v,p=n(1001),h=(0,p.Z)(f,a,r,!1,null,null,null),x=h.exports},81428:function(e,t,n){n.d(t,{Js:function(){return s},UU:function(){return r},ib:function(){return i}});var a=n(25972);function r(e){return(0,a.Z)({url:"/v1/works",method:"post",data:e})}function i(){return(0,a.Z)({url:"/v1/works",method:"get"})}function s(e){return(0,a.Z)({url:"/v1/works/".concat(e),method:"delete"})}}}]);
//# sourceMappingURL=419-legacy.6ade7168.js.map